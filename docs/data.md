# НТО 2025/2026 — ИИ — Этап 2А: Описание данных и формата решений

Этот документ является справочником по данным и формату файла решения для задачи «Этап 2А: Предсказание оценок».

---

## 1. Описание данных

**Основной формат исходных данных:** CSV с разделителем точка с запятой (`;`) и двойными кавычками (`"`) для экранирования текстовых полей.

### 1.0. Получение данных

Данные расположены по ссылке: [https://drive.google.com/drive/folders/1ioqrB9146B9DLcEVD7V3LIl46IYAyBfm](https://drive.google.com/drive/folders/1ioqrB9146B9DLcEVD7V3LIl46IYAyBfm)

При запуске команды `make download-data` данные будут автоматически скачаны и подготовлены к использованию.

### 1.1. Состав предоставляемых файлов

| Файл | Описание |
|------|----------|
| `stage1_public_train.csv` | Обучающая выборка. Содержит историю взаимодействий, включая целевую переменную rating. Формат CSV с разделителем точка с запятой (`;`). |
| `stage1_public_test.csv` | Тестовая выборка. Содержит пары (user_id, book_id), для которых необходимо предсказать оценку. Не содержит колонку rating. |
| `stage1_sample_submission.csv` | Пример файла решения. Демонстрирует корректный формат для отправки на проверку. |
| `stage1_public_books.csv` | Метаданные книг (автор, год публикации и т.д.). |
| `stage1_public_users.csv` | Метаданные пользователей (пол, возраст). |
| `stage1_public_genres.csv` | Справочник жанров. |
| `stage1_public_book_genres.csv` | Таблица для связи книг и жанров (многие-ко-многим). |
| `stage1_public_book_descriptions.csv` | Текстовые описания книг. Используется для извлечения признаков через TF-IDF и BERT. |

### 1.2. Описание полей в метаданных

#### stage1_public_books.csv: Информация о книгах

| Поле | Тип | Описание |
|------|-----|----------|
| `book_id` | int64 | Уникальный идентификатор книги (первичный ключ). |
| `title` | str | Название книги. |
| `author_id` | int64 | Уникальный идентификатор автора. |
| `author_name` | str | Имя автора. |
| `publication_year` | int64 | Год публикации. |
| `language` | int64 | Числовой код языка книги. |
| `avg_rating` | float64 | Средняя оценка книги (рассчитана по всем взаимодействиям). |
| `publisher` | int64 | Числовой код издательства. |

#### stage1_public_users.csv: Информация о пользователях

| Поле | Тип | Описание |
|------|-----|----------|
| `user_id` | int64 | Уникальный идентификатор пользователя (первичный ключ). |
| `gender` | int64 | Пол пользователя (1 — мужской, 2 — женский). |
| `age` | int64 | Возраст пользователя. |

#### stage1_public_genres.csv: Справочник жанров

| Поле | Тип | Описание |
|------|-----|----------|
| `genre_id` | int64 | Уникальный идентификатор жанра (первичный ключ). |
| `genre_name` | str | Название жанра. |
| `books_count` | int64 | Общее количество книг в данном жанре. |

#### stage1_public_book_genres.csv: Связь книг и жанров

| Поле | Тип | Описание |
|------|-----|----------|
| `book_id` | int64 | Идентификатор книги (внешний ключ к stage1_public_books.csv). |
| `genre_id` | int64 | Идентификатор жанра (внешний ключ к stage1_public_genres.csv). |

#### stage1_public_book_descriptions.csv: Описания книг

| Поле | Тип | Описание |
|------|-----|----------|
| `book_id` | int64 | Идентификатор книги (внешний ключ к stage1_public_books.csv). |
| `description` | str | Текстовое описание книги. Может содержать пустые значения. |

**Примечание:** Описания используются для извлечения признаков двумя способами:
- **TF-IDF**: создание разреженных признаков на основе термов и биграмм из описаний
- **BERT embeddings**: получение плотных векторных представлений текста через предобученную модель `DeepPavlov/rubert-base-cased`

---

## 2. Формат файла решения (сабмита)

Файл с решением должен быть представлен в формате CSV с разделителем запятая (`,`). Файл может содержать заголовок, который будет проигнорирован при проверке.

**Структура колонок:** `user_id,book_id,rating_predict`

**Требования:**
- `user_id`, `book_id` — идентификаторы, соответствующие парам из файла `stage1_public_test.csv`. Порядок строк в файле решения не важен.
- `rating_predict` — предсказанное значение оценки. Вещественное число в диапазоне от 0 до 10. Округлять не требуется. Система автоматически ограничит значения диапазоном [0, 10].
- Файл должен содержать предсказания для всех пар из `stage1_public_test.csv`.
- Максимальный размер файла: 50 МБ.

**Пример содержимого submission.csv:**

```
user_id,book_id,rating_predict
150,25357,7.854
150,18,9.102
24995,136814,5.500
```
